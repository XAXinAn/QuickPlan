# OCR 模型文件下载清单

## ✅ 必需下载的 3 个文件

---

### 📦 文件 1: 文字检测模型

**文件名**: `ch_PP-OCRv4_det_infer.tar`  
**功能**: 检测图片中文字的位置  
**大小**: 约 3-4 MB (压缩后), 解压后约 8-10 MB  
**下载地址**: 
```
https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_det_infer.tar
```

**直接点击下载**: [点击这里下载检测模型](https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_det_infer.tar)

---

### 📦 文件 2: 文字识别模型

**文件名**: `ch_PP-OCRv4_rec_infer.tar`  
**功能**: 识别检测到的文字内容  
**大小**: 约 8-10 MB (压缩后), 解压后约 20-25 MB  
**下载地址**:
```
https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_rec_infer.tar
```

**直接点击下载**: [点击这里下载识别模型](https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_rec_infer.tar)

---

### 📦 文件 3: 字符字典

**文件名**: `ppocr_keys_v1.txt`  
**功能**: 中文字符映射表  
**大小**: 约 8 KB  
**下载地址**:
```
https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt
```

**直接点击下载**: [点击这里下载字典文件](https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt)

**注意**: 如果 GitHub Raw 链接无法访问,可以使用以下镜像:
```
https://ghproxy.com/https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt
```

---

## 🚀 快速下载方法

### 方法 1: 使用下载脚本 (推荐)

**Windows 用户**:
```powershell
# 在项目根目录打开 PowerShell
.\download_ocr_models.ps1
```

**Linux/Mac 用户**:
```bash
# 在项目根目录打开终端
chmod +x download_ocr_models.sh
./download_ocr_models.sh
```

### 方法 2: 浏览器直接下载

直接复制上面的下载地址到浏览器地址栏,按回车即可下载。

### 方法 3: 使用命令行

**Windows PowerShell**:
```powershell
# 下载检测模型
Invoke-WebRequest -Uri "https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_det_infer.tar" -OutFile "ch_PP-OCRv4_det_infer.tar"

# 下载识别模型
Invoke-WebRequest -Uri "https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_rec_infer.tar" -OutFile "ch_PP-OCRv4_rec_infer.tar"

# 下载字典
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt" -OutFile "ppocr_keys_v1.txt"
```

**Linux/Mac 终端**:
```bash
# 使用 wget
wget https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_det_infer.tar
wget https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_rec_infer.tar
wget https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt

# 或使用 curl
curl -L -O https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_det_infer.tar
curl -L -O https://paddleocr.bj.bcebos.com/PP-OCRv4/chinese/ch_PP-OCRv4_rec_infer.tar
curl -L -O https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt
```

---

## 📋 下载后的处理步骤

### 步骤 1: 解压 .tar 文件

**Windows** (需要 7-Zip 或 WinRAR):
- 右键点击 `.tar` 文件
- 选择 "解压到当前文件夹"

**Linux/Mac**:
```bash
tar -xvf ch_PP-OCRv4_det_infer.tar
tar -xvf ch_PP-OCRv4_rec_infer.tar
```

解压后会得到:
- `ch_PP-OCRv4_det_infer/` 文件夹 (包含 `inference.pdmodel` 和 `inference.pdiparams`)
- `ch_PP-OCRv4_rec_infer/` 文件夹 (包含 `inference.pdmodel` 和 `inference.pdiparams`)

### 步骤 2: 转换为 .nb 格式 ⚠️

**这是最关键的一步!** 下载的模型是 Paddle 格式,需要转换为 Android 可用的 `.nb` 格式。

#### 2.1 下载 PaddleLite opt 工具

访问: https://github.com/PaddlePaddle/Paddle-Lite/releases

下载适合您系统的 `opt` 工具:
- Linux: `opt_linux`
- Mac: `opt_mac`
- Windows: 需要在 WSL 或虚拟机中使用 Linux 版本

#### 2.2 转换模型

```bash
# 给 opt 工具执行权限 (Linux/Mac)
chmod +x opt_linux

# 转换检测模型
./opt_linux \
  --model_file=ch_PP-OCRv4_det_infer/inference.pdmodel \
  --param_file=ch_PP-OCRv4_det_infer/inference.pdiparams \
  --optimize_out=ch_PP-OCRv4_det_infer \
  --valid_targets=arm

# 转换识别模型
./opt_linux \
  --model_file=ch_PP-OCRv4_rec_infer/inference.pdmodel \
  --param_file=ch_PP-OCRv4_rec_infer/inference.pdiparams \
  --optimize_out=ch_PP-OCRv4_rec_infer \
  --valid_targets=arm
```

转换成功后会生成:
- `ch_PP-OCRv4_det_infer.nb`
- `ch_PP-OCRv4_rec_infer.nb`

### 步骤 3: 放置到项目

创建目标目录 (如果不存在):
```bash
mkdir -p app/src/main/assets/ocr
```

复制 3 个文件:
```bash
cp ch_PP-OCRv4_det_infer.nb app/src/main/assets/ocr/
cp ch_PP-OCRv4_rec_infer.nb app/src/main/assets/ocr/
cp ppocr_keys_v1.txt app/src/main/assets/ocr/
```

**Windows 用户**: 直接使用文件资源管理器复制文件到目标目录

最终目录结构:
```
app/src/main/assets/ocr/
├── ch_PP-OCRv4_det_infer.nb      ✓
├── ch_PP-OCRv4_rec_infer.nb      ✓
└── ppocr_keys_v1.txt             ✓
```

---

## 🆘 简化方案 (如果转换太麻烦)

如果您觉得模型转换过程太复杂,可以:

### 选项 1: 使用预转换的模型

搜索关键词: `PaddleOCR nb 模型 Android`

可能的来源:
- CSDN 下载频道
- GitHub Issue 中的分享
- 百度网盘分享链接
- PaddleOCR 交流群

### 选项 2: 使用 PaddleOCR Android Demo

访问: https://github.com/PaddlePaddle/PaddleOCR/tree/release/2.7/deploy/android_demo

官方 Android Demo 中可能包含已转换好的模型文件。

---

## ❓ 常见问题

### Q1: 下载速度太慢怎么办?

**解决方案**:
1. 使用下载工具 (迅雷、IDM、Free Download Manager)
2. 寻找国内网盘分享
3. 在 CSDN 或 GitHub 上搜索别人分享的链接

### Q2: GitHub Raw 链接无法访问?

**解决方案**:
使用镜像站:
```
https://ghproxy.com/https://raw.githubusercontent.com/PaddlePaddle/PaddleOCR/release/2.7/ppocr/utils/ppocr_keys_v1.txt
```

或者直接访问 GitHub 仓库下载:
https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.7/ppocr/utils/ppocr_keys_v1.txt

点击 "Raw" 按钮,然后右键保存文件。

### Q3: 没有 Linux 环境怎么转换模型?

**解决方案**:
1. **Windows 用户**: 安装 WSL (Windows Subsystem for Linux)
2. **使用虚拟机**: VirtualBox + Ubuntu
3. **在线转换**: 搜索是否有在线转换服务
4. **直接找转换好的**: 在网上搜索已转换的 .nb 文件

### Q4: 可以跳过模型转换吗?

**不可以!** Android 应用必须使用 `.nb` 格式的模型文件。`.tar` 中的 `.pdmodel` 和 `.pdiparams` 文件是 Paddle 原始格式,无法在移动端使用。

---

## 📞 需要帮助?

如果在下载或转换过程中遇到问题:

1. 查看 `OCR功能使用指南.md` 中的详细说明
2. 访问 PaddleOCR 官方文档: https://github.com/PaddlePaddle/PaddleOCR
3. 在项目 Issue 中提问
4. 加入 PaddleOCR 交流群

---

## ✅ 验证清单

下载和放置完成后,请确认:

- [ ] 文件 `app/src/main/assets/ocr/ch_PP-OCRv4_det_infer.nb` 存在
- [ ] 文件 `app/src/main/assets/ocr/ch_PP-OCRv4_rec_infer.nb` 存在
- [ ] 文件 `app/src/main/assets/ocr/ppocr_keys_v1.txt` 存在
- [ ] 文件大小正确 (det: 3-4 MB, rec: 8-10 MB, dict: 8 KB)
- [ ] 文件格式正确 (.nb 而不是 .tar 或 .pdmodel)

全部确认后,即可编译运行应用!

---

**祝下载顺利! 🎉**
